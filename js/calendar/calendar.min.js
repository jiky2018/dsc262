!function(t){"function"==typeof define?define("xvDate",[],function(e,s,i){var a={};t(a),i.exports=a.xvDate}):t(window)}(function(t){var e={};t.xvDate=function(t){var s=t.triggerId||t.targetId;if("object"==typeof s&&s.length)for(var i=[],a=0;a<s.length;a++)i.push(e.getId(s[a])),e.enable(i[a],i,t);else i=e.getId(s),e.enable(i,i,t)},e.fn=e.prototype={init:function(t){this.creatView(t),this.initTimes(!1)},gb:{},creatView:function(t){var s,i=t||{},a=this,n=i.targetId||"dates",r=e.getId(n);if(a.gb.algin=i.alignId?e.getId(i.alignId):r,a.gb.format=i.format||"-",a.gb.hms="off"!==i.hms||null,a.gb.zIndex=i.zIndex||9999,a.gb.position=i.position||"position",a.gb.trigger=i.trigger,a.limitTime(i.min,"minTime"),a.limitTime(i.max,"maxTime"),a.gb.datesBox)a.gb.target===r||a.ishd(a.gb.datesBox)?a.shde(a.gb.datesBox):(e.removeEvent(document,"click",a.docArea),a.shde(a.gb.datesBox,2)),a.gb.target=r,a.setPosition(a.gb.algin,a.gb.datesBox,{left:0,top:0}),a.setPosition(a.gb.algin,a.gb.datesBox),s={that:a},e.removeEvent(document,"click",a.docArea),e.addEvent(document,"click",a.docArea,s),a.gb.datesBox.style.zIndex=a.gb.zIndex;else{var o=a.gb.datesBox=a.creatEle("div");a.gb.datesBox.id="xv_Dates_box",a.gb.target=r,a.gb.datesBox.className="dates_box",a.gb.datesBox.style.display="block",a.gb.datesBox.style.zIndex=a.gb.zIndex,a.gb.datesBox.style.position=a.gb.position,a.append(a.gb.datesBox),o.innerHTML="<div class='dates_box_top'><div class='dates_yy dates_choose'><span class='prev_choose choose_btn' id='xv_Yy_prev'><i class='sign'></i></span><span class='ipt_wrap' id='xv_Year_wrap'><input class='dlt_status' style='width:32px;margin-left:4px;' id='xv_Ipt_year' type='text'><small>年</small><i class='sign'></i></span><span class='next_choose choose_btn' id='xv_Yy_next'><i class='sign'></i></span><div class='dates_yy_list' id='xv_Dates_yy_list' style='display:none'>"+function(){for(var t="",e=1970;2100>e;e++)t+="<span dateValue = "+e+">"+e+"</span>";return t}()+"</div></div><div class='dates_mm dates_choose'><span class='prev_choose choose_btn' id='xv_Mm_prev'><i class='sign'></i></span><span class='ipt_wrap' id='xv_Moth_wrap'><input class='dlt_status' style='width:16px;margin-left:10px;' id='xv_Ipt_month' type='text'><small>月</small><i class='sign'></i></span><span class='next_choose choose_btn' id='xv_Mm_next'><i class='sign'></i></span><div class='dates_mm_list' id='xv_Dates_mm_list' style='display:none'>"+function(){for(var t="",e=1;13>e;e++)t+=10>e?"<span dateValue ="+e+">0"+e+"月</span>":"<span dateValue ="+e+">"+e+"月</span>";return t}()+"</div></div></div>"+this.viewTb()+"<div class='dates_bottom'><ul id='dates_hms' class='dates_hms' style='display:block' ><li class='time_tag'>时间</li><li><input type='text' id='xv_Hours' class='dlt_status'><span>:</span></li><li><input type='text' id='xv_Minutes' class='dlt_status'><span>:</span></li><li><input type='text' id='xv_Seconds' class='dlt_status'><span>&nbsp;</span></li></ul><div class='dates_btn'><a id='xv_Dates_clear'>清空</a><a id='xv_Dates_today'>今天</a><a id='xv_Dates_ok'>确认</a></div></div>",a.handleTime(),a.gb.datesHms=e.getId("dates_hms"),a.setPosition(a.gb.algin,a.gb.datesBox,{left:0,top:0}),a.setPosition(a.gb.algin,a.gb.datesBox),s={that:a},e.addEvent(document,"click",a.docArea,s)}var d=this.gb.datesHms;d?this.shde(d,2):this.shde(d,1);var m=i.triggerId||i.targetId;if("object"==typeof m&&m.length){a.gb.trigger=[];for(var l=0;l<m.length;l++)a.gb.trigger.push(e.getId(m[l]))}else a.gb.trigger=e.getId(m)},docArea:function(t){var e=t.srcElement||t.target,s=t.datas.that;!s.ishd(s.gb.datesBox)&&!s.contain(s.gb.datesBox,e)&&e!==s.gb.target&&!s.isExistObj(s.gb.trigger,e)&&s.shde(s.gb.datesBox,1)},limitTime:function(t,e){var s=this.checkTime(t);this.gb[e]=s?this.datesSplit(s):null},datesSplit:function(t){return t?(datesTimeArr=t.split(" "),datesArr=datesTimeArr[0].split(/[-\/]/),timesArr=this.gb.hms&&datesTimeArr[1]?datesTimeArr[1].split(":"):null,{year:datesArr[0],month:datesArr[1],date:datesArr[2],hours:timesArr?timesArr[0]:0,minutes:timesArr?timesArr[1]:0,seconds:timesArr?timesArr[2]:0}):t},handleTime:function(){var t=this;t.gb.td=e.getId("dates_table").getElementsByTagName("td");for(var s=t.gb.els={yearWrap:e.getId("xv_Year_wrap"),monthWrap:e.getId("xv_Moth_wrap"),yyList:e.getId("xv_Dates_yy_list"),mmList:e.getId("xv_Dates_mm_list"),yyConList:e.getId("xv_Dates_yy_list").getElementsByTagName("span"),mmConList:e.getId("xv_Dates_mm_list").getElementsByTagName("span"),yyPrev:e.getId("xv_Yy_prev"),yyNext:e.getId("xv_Yy_next"),mmPrev:e.getId("xv_Mm_prev"),mmNext:e.getId("xv_Mm_next"),datesClear:e.getId("xv_Dates_clear"),datesToday:e.getId("xv_Dates_today"),datesOk:e.getId("xv_Dates_ok"),iptYear:e.getId("xv_Ipt_year"),iptMonth:e.getId("xv_Ipt_month"),iptHours:e.getId("xv_Hours"),iptMinutes:e.getId("xv_Minutes"),iptSeconds:e.getId("xv_Seconds")},i=[s.iptYear,s.iptMonth,s.iptHours,s.iptMinutes,s.iptSeconds],a=0;a<i.length;a++)e.addEvent(i[a],"click",t.focusStatus);e.addEvent(s.iptYear,"blur",function(){var e=this,s=t.checkFocus("^((19[0-9]{2})|(2[0-9]{3}))$",e,t.gb.time.year);s&&(t.gb.time.year=s,t.insertDate())}),e.addEvent(s.iptMonth,"blur",function(){var e=this,s=t.checkFocus("^((0[1-9])|(1[0-2])|[1-9])$",e,t.formatTime(t.gb.time.month));s&&(t.gb.time.month=s,t.insertDate())}),e.addEvent(s.iptHours,"blur",function(){var e=this;t.gb.time.hours=t.checkFocus("^(([0-1][0-9])|(2[0-3])|[0-9])$",e,"00")}),e.addEvent(s.iptMinutes,"blur",function(){var e=this;t.gb.time.minutes=t.checkFocus("^(([0-5][0-9])|[0-9])$",e,"00")}),e.addEvent(s.iptSeconds,"blur",function(){var e=this;t.gb.time.seconds=t.checkFocus("^(([0-5][0-9])|[0-9])$",e,"00")}),e.addEvent(s.datesClear,"click",function(){t.gb.target.value=""}),e.addEvent(s.datesOk,"click",function(){var e=t.gb.hms?"hms":"ymd",s=t.gb.time;t.compareTime(s.year,s.month,s.date,e)&&t.getOkTime()}),e.addEvent(s.datesToday,"click",function(){t.initTimes(!0)}),e.addEvent(s.yearWrap,"click",t.yearLst,{els:s,that:t}),e.addEvent(t.gb.datesBox,"click",t.ymLst,{els:s,that:t}),t.ymClick(s.yyConList,s.yyList,"year"),t.ymClick(s.mmConList,s.mmList,"month"),e.addEvent(s.monthWrap,"click",function(){"none"===s.mmList.style.display?document.activeElement!==s.iptMonth&&(s.mmList.style.display="block"):s.mmList.style.display="none"});var n={mmPrev:[-1,"month"],mmNext:[1,"month"],yyPrev:[-1,"year"],yyNext:[1,"year"]};for(a in n)e.addEvent(s[a],"click",t.datesBtn,{that:t,direction:n[a][0],type:n[a][1]});for(a=0;a<t.gb.td.length;a++)e.addEvent(t.gb.td[a],"click",t.getDate,{that:t})},getDate:function(t){var e,s=this.innerHTML,i=t.datas.that,a=parseInt(this.getAttribute("m"),10);e=1===i.gb.time.month&&12===a?i.gb.time.year-1:12===i.gb.time.month&&1===a?i.gb.time.year+1:i.gb.time.year,i.compareTime(e,a,s)&&(i.gb.time.year=e,i.gb.time.month=a,i.gb.time.date=s,i.insertDate(),i.getOkTime())},yearLst:function(t){var e=t.datas.els,s=t.datas.that;if("none"===e.yyList.style.display){if(document.activeElement!==e.iptYear){e.yyList.style.display="block";for(var i=0;i<e.yyConList.length;i++)if(e.yyConList[i].getAttribute("dateValue")===s.gb.time.year){var a=e.yyConList[i].offsetTop;a>170&&(e.yyList.scrollTop=a)}}}else e.yyList.style.display="none"},ymLst:function(t){var e=t.srcElement||t.target,s=t.datas.els,i=t.datas.that;i.contain(s.yearWrap,e)||i.ishd(s.yyList)||(s.yyList.style.display="none"),i.contain(s.monthWrap,e)||i.ishd(s.mmList)||(s.mmList.style.display="none")},focusStatus:function(){this.focus&&(this.select(),this.className="")},combineTime:function(t,e){var s;if(!t)return!1;var i=t.year.toString(),a=this.formatTime(t.month.toString()),n=this.formatTime(t.date.toString()),r=this.formatTime(t.hours.toString()),o=this.formatTime(t.minutes.toString()),d=this.formatTime(t.seconds.toString());switch(e){case"hms":s=i+a+n+r+o+d;break;case"ymd":s=i+a+n;break;case"ym":s=i+a;break;case"y":s=i;break;default:s=i+a+n}return parseInt(s,10)},compareTime:function(t,e,s,i){var a=this,n=a.gb.time,r=a.combineTime({year:t,month:e,date:s,hours:n.hours,minutes:n.seconds,seconds:n.minutes},i),o=a.combineTime(a.gb.minTime,i)||"",d=a.combineTime(a.gb.maxTime,i)||"";return o&&!d?!(o>r)||null:!o&&d?!(r>d)||null:!(o&&d&&(r>d||o>r))||null},initTimes:function(t){var e,s,i,a,n,r,o,d,m=this.gb.target,l=this.checkTime(m.value);l&&(l=this.datesSplit(l)),t?(d=new Date,e=d.getDate(),s=d.getFullYear(),i=d.getMonth()+1,a=d.getHours(),n=d.getMinutes(),r=d.getSeconds()):!t&&l?(e=l.date,s=l.year,i=l.month,a=l.hours,n=l.minutes,r=l.seconds):t||this.gb.minTime||this.gb.maxTime||l?l||!this.gb.minTime&&!this.gb.maxTime||(o=this.gb.minTime||this.gb.maxTime,e=o.date,s=o.year,i=o.month,a=o.hours,n=o.minutes,r=o.seconds):(d=new Date,e=d.getDate(),s=d.getFullYear(),i=d.getMonth()+1,a=0,n=0,r=0),this.gb.time={year:s,month:i,date:e,hours:a,minutes:n,seconds:r},this.insertDate()},viewTb:function(){var t=["日","一","二","三","四","五","六"],e=[],s=0,i=this.creatEle("table"),a=this.creatEle("thead"),n=this.creatEle("tbody");i.className="dates_table",i.id="dates_table";for(var r=1;8>r;r++){var o=this.creatEle("th");this.append(o,a),o.innerHTML=t[r-1]}for(r=1;7>r;r++){e[r]=this.creatEle("tr"),this.append(e[r],n);for(var d=1;8>d;d++){var m=this.creatEle("td");m.setAttribute("index",s++),this.append(m,e[r])}}return this.append(a,i),this.append(n,i),i.outerHTML},insertDate:function(){var t,e,s=this.gb.els,i=this.gb.time,a=s.yyConList,n=s.mmConList,r=s.iptYear,o=s.iptMonth,d=s.iptHours,m=s.iptMinutes,l=s.iptSeconds,c=i.year,g=parseInt(i.month,10),h=i.date,u=i.hours,b=i.minutes,y=i.seconds,v=this.gb.td,p=new Date;p.setFullYear(c,g-1),p.setDate(1);var f=p.getDay(),_=this.getDays(c,g-1);this.dateStatus(n,g,"current"),this.dateStatus(a,c,"current");for(var x=0;_>x;x++)v[f+x].innerHTML=x+1,v[f+x].className="",x+1===h?v[f+x].className="current_day":h>_&&(v[f+_-1].className="current_day",this.gb.time.date=_),v[f+x].setAttribute("m",g),v[f+x].setAttribute("y",c);for(x=0;f>x;x++)v[f-x-1].className="other_day",v[f-x-1].innerHTML=this.getDays(c,g-2)-x,g-1>0?(t=g-1,e=c):(t=12,e=c-1),v[f-x-1].setAttribute("m",t),v[f-x-1].setAttribute("y",e);for(x=0;x<v.length-f-_;x++)v[f+_+x].className="other_day",v[f+_+x].innerHTML=x+1,g+1>12?(t=1,e=c+1):(t=g+1,e=c),v[f+_+x].setAttribute("m",t),v[f+_+x].setAttribute("y",e);var T=this.combineTime(this.gb.minTime)||"",E=this.combineTime(this.gb.maxTime)||"",I={year:c,month:g,date:h,hours:this.gb.time.hours,minutes:this.gb.time.minutes,seconds:y};if(T){for(x=0;x<v.length;x++)I.year=v[x].getAttribute("y"),I.date=v[x].innerHTML,I.month=v[x].getAttribute("m"),this.combineTime(I)<T&&(v[x].className="disable_day");for(x=0;x<a.length;x++)a[x].getAttribute("dateValue")<this.gb.minTime.year&&(a[x].className="disable_day");for(x=0;x<n.length;x++)i.year+this.formatTime(n[x].getAttribute("dateValue"))<this.combineTime(this.gb.minTime,"ym")&&(n[x].className="disable_day")}if(E){for(x=0;x<v.length;x++)I.year=v[x].getAttribute("y"),I.date=v[x].innerHTML,I.month=v[x].getAttribute("m"),this.combineTime(I)>E&&(v[x].className="disable_day");for(x=0;x<a.length;x++)a[x].getAttribute("dateValue")>this.gb.maxTime.year&&(a[x].className="disable_day");for(x=0;x<n.length;x++)i.year+this.formatTime(n[x].getAttribute("dateValue"))>this.combineTime(this.gb.maxTime,"ym")&&(n[x].className="disable_day")}r.value=c,o.value=this.formatTime(g),d.value=this.formatTime(u),m.value=this.formatTime(b),l.value=this.formatTime(y)},ymClick:function(t,e,s){function i(){"month"===s?(n=this.getAttribute("dateValue"),a=o.gb.time.year,r=o.gb.time.date):"year"===s&&(a=this.getAttribute("dateValue"),n=o.gb.time.month,r=o.gb.time.date),o.compareTime(a,n,r)&&(o.gb.time.year=a,o.gb.time.month=n,o.gb.time.date=r,o.removeStatus(t),this.className="current",e.style.display="none",o.insertDate())}for(var a,n,r,o=this,d=0;d<t.length;d++)t[d].onclick=i},ishd:function(t){return"none"===t.style.display||null},shde:function(t,e){e?1===e?t.style.display="none":2===e&&(t.style.display="block"):t.style.display="block"===t.style.display?"none":"block"},isExistObj:function(t,e){if("object"==typeof t&&t.length){for(var s=0;s<t.length;s++)if(t[s]===e)return!0}else if(t===e)return!0;return!1},checkFocus:function(t,e,s,i){e.className="dlt_status";var a=e.value;return new RegExp(t).test(a)?(this.gb.time[i]=this.formatTime(a),e.value=this.gb.time[i]):e.value=s,e.value},datesBtn:function(t){var e=t.datas.that,s=e.gb.time.year,i=e.gb.time.month,a=parseInt(s,10),n=parseInt(i,10),r=e.gb.time.date,o=t.datas.type,d=t.datas.direction;if("month"===o){1===n&&0>d?(i=12,s=a+d):12===n&&d>0?(i=1,s=a+1):i=n+d;var m=e.getDays(s,i-1);r>m&&(r=m)}else"year"===o&&(s=a+d);e.gb.time.year=s,e.gb.time.month=i,e.gb.time.date=r,e.insertDate()},removeStatus:function(t){for(var e=0;e<t.length;e++)t[e].className=""},dateStatus:function(t,e,s){for(var i=0;i<t.length;i++)t[i].className="",t[i].getAttribute("dateValue")===e&&(t[i].className=s)},getOkTime:function(){var t,e,s={},i=this.gb.format;for(var a in this.gb.time)s[a]=this.formatTime(this.gb.time[a]);e=" "+s.hours+":"+s.minutes+":"+s.seconds,t=this.gb.hms?e:"",this.gb.target.value=s.year+i+s.month+i+s.date+t,this.shde(this.gb.datesBox)},checkTime:function(t){var e=this.gb.hms?"(\\s){1}((0?[0-9])|(1[0-9])|(2[0-3])):([0-5][0-9]):([0-5][0-9])":"",s=t?t.replace(/^(\s*)|(\s*)$/g,"").replace(/(\s)+/g," "):"";return!!new RegExp("^((19[0-9]{2})|(2[0-9]{3}))[-/]((0?[1-9])|(1[0-2]))[-/]((0?[1-9])|(1[0-9])|(2[0-9])|(3[0-1]))"+e+"$").test(s)&&s},formatTime:function(t){return/^(\d){1}$/.test(t)?"0"+t:t},getDays:function(t,e){var s;return 0>e?(e=11,t-=1):e>11&&(e=0,t+=1),e+1===2&&(s=t%4==0&&t%100!=0||t%400==0?29:28),[31,s,31,30,31,30,31,31,30,31,30,31][e]},creatEle:function(t,e){return(e||document).createElement(t)},append:function(t,e){return(e||document.body).appendChild(t)},setPosition:function(t,e,s){if(s&&"object"==typeof s)return e.style.left=0,e.style.top=0,!1;var i=this.getOffset(t),a=i.left,n=i.top,r=e.offsetHeight,o=t.offsetHeight,d=this.resetSizeAttr("scrollTop"),m=this.resetSizeAttr("offsetHeight"),l=n-d;e.style.top=m-l>r?n+o-1+"px":n-r+1+"px",e.style.left=a+"px"},resetSizeAttr:function(t,e){return(e||document.body)[t]||document.documentElement&&document.documentElement[t]},getOffset:function(t,e){var s=e||{left:0,top:0};return t&&(s.left+=t.offsetLeft,s.top+=t.offsetTop,t.offsetParent&&(t=t.offsetParent,arguments.callee(t,s))),s},contain:function(t,e){return document.all?t.contains(e):20===t.compareDocumentPosition(e)||t===e||null}},e.enable=function(s,i,a){e.addEvent(s,"click",function(){t.xvDate.Dates?t.xvDate.Dates.init(a,i):t.xvDate.Dates=new e.fn.init(a,i)})},e.getId=function(t,e){return(e||document).getElementById(t)},e.addEvent=function(t,e,s,i){t["evt"+e+s]=t["evt"+e+s]||null,t["evt"+e+s]||(t["evt"+e+s]=function(e){e=e||window.event,e.datas=i||{},s.call(t,e)}),t.addEventListener?t.addEventListener(e,t["evt"+e+s],!1):t.attachEvent&&t.attachEvent("on"+e,t["evt"+e+s])},e.removeEvent=function(t,e,s){void 0!==t.removeEventListener?t.removeEventListener(e,t["evt"+e+s],!1):void 0!==t.detachEvent&&s&&t["evt"+e+s]&&t.detachEvent("on"+e,t["evt"+e+s])},e.fn.init.prototype=e.fn});